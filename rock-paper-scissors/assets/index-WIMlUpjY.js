(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();const v=()=>({gameState:"idle",playerChoice:null,computerChoice:null,result:null,countdown:0,choices:["rock","paper","scissors"],pulseSize:1,pulseDir:1}),y=o=>{if(!o.playerChoice||!o.computerChoice){o.result=null;return}if(o.playerChoice===o.computerChoice){o.result="draw";return}const e={rock:"scissors",paper:"rock",scissors:"paper"};o.result=e[o.playerChoice]===o.computerChoice?"win":"lose"},C=o=>{o.computerChoice=o.choices[Math.floor(Math.random()*o.choices.length)]};class E{game;constructor(e){this.game=e}handleClick(e,n){this.handleInput(e,n.clientX,n.clientY)}handleTouch(e,n){const i=n.touches[0];this.handleInput(e,i.clientX,i.clientY)}handleInput(e,n,i){const s=this.game.canvas,r=s.getBoundingClientRect(),u=n-r.left,d=i-r.top,f=s.width/2,m=s.height/2,t=50;switch(e.gameState){case"idle":this.handleIdleState(e,u,d,f,m,t);break;case"player-choose":this.handlePlayerChooseState(e,u,d,f,m,t);break;case"result":e.countdown<=0&&this.handleResultState(e,u,d,f,m,t);break}}handleIdleState(e,n,i,s,r,u){const d=r+100;Math.hypot(n-s,i-d)<u&&(e.gameState="player-choose")}handlePlayerChooseState(e,n,i,s,r,u){const d=r+50,f=100;e.choices.forEach((m,t)=>{const a=s+(t-1)*f;Math.hypot(n-a,i-d)<u&&(e.playerChoice=m,e.gameState="result",e.countdown=60,C(e),y(e))})}handleResultState(e,n,i,s,r,u){const d=r+150;Math.hypot(n-s,i-d)<u&&this.resetGameState(e)}resetGameState(e){e.gameState="player-choose",e.playerChoice=null,e.computerChoice=null,e.result=null,e.countdown=0,e.pulseSize=1,e.pulseDir=1}}const T=o=>new E(o),b=()=>{const o={rock:new Image,paper:new Image,scissors:new Image},e={rock:!1,paper:!1,scissors:!1},n=t=>new Promise(a=>{o[t].src=`/pages/rock-paper-scissors/assets/${t}.png`,o[t].onload=()=>{e[t]=!0,a()},o[t].onerror=()=>{console.error(`Failed to load sprite: ${t}`),a()}}),i=async()=>{await Promise.all([n("rock"),n("paper"),n("scissors")])},s=(t,a,l,c,h)=>{if(!a||!e[a]){r(t,a,l,c,h);return}t.save(),t.translate(l,c);const p=o[a].naturalWidth/o[a].naturalHeight,g=h,w=h/p;t.drawImage(o[a],-g/2,-w/2,g,w),t.restore()},r=(t,a,l,c,h)=>{t.save(),t.translate(l,c),t.beginPath(),t.arc(0,0,h/2,0,Math.PI*2),t.fillStyle="#cccccc",t.fill(),t.strokeStyle="#999999",t.stroke(),a&&(t.font=`${h/3}px Arial`,t.textAlign="center",t.textBaseline="middle",t.fillStyle="#333333",t.fillText(a.charAt(0).toUpperCase(),0,0)),t.restore()},u=(t,a,l,c)=>{t.font="bold 30px Arial",t.textAlign="center",t.fillStyle="#4cc9f0",t.fillText("Rock Paper Scissors",a,l),t.beginPath(),t.arc(a,l+100,50,0,Math.PI*2),t.fillStyle="#4CAF50",t.fill(),t.font="bold 20px Arial",t.fillStyle="white",t.fillText("START",a,l+105),t.save(),t.translate(a,l-100),t.scale(c.pulseSize,c.pulseSize),s(t,"rock",-50,0,60),s(t,"paper",0,0,60),s(t,"scissors",50,0,60),t.restore()},d=(t,a,l,c)=>{t.font="24px Arial",t.textAlign="center",t.fillStyle="#90e0ef",t.fillText("Choose your move:",a,l-80);const h=l+50,p=100;c.choices.forEach((g,w)=>{const S=a+(w-1)*p;s(t,g,S,h,80)})},f=(t,a,l,c)=>{if(c.playerChoice&&s(t,c.playerChoice,a-100,l,100),t.font="18px Arial",t.textAlign="center",t.fillStyle="#90e0ef",t.fillText("You",a-100,l+100),t.font="bold 24px Arial",t.fillStyle="#f72585",t.fillText("VS",a,l+30),c.countdown>0&&c.computerChoice){const h=1-c.countdown/60;t.save(),t.translate(a+100,l),t.scale(h,h),s(t,c.computerChoice,0,0,100),t.restore()}else if(c.computerChoice){s(t,c.computerChoice,a+100,l,100),t.fillText("Computer",a+100,l+100);let h="",p="";switch(c.result){case"win":h="You Win!",p="#4CAF50";break;case"lose":h="You Lose!",p="#F44336";break;case"draw":h="Draw!",p="#FFC107";break}h&&p&&(t.font="bold 30px Arial",t.fillStyle=p,t.fillText(h,a,l-120)),t.beginPath(),t.arc(a,l+170,50,0,Math.PI*2),t.fillStyle="#2196F3",t.fill(),t.font="bold 16px Arial",t.fillStyle="white",t.fillText("PLAY",a,l+175)}},m=(t,a,l)=>{const c=a.width/2,h=a.height/2;switch(l.gameState){case"idle":u(t,c,h,l);break;case"player-choose":d(t,c,h,l);break;case"result":f(t,c,h,l);break}};return i(),{renderGame:m}},k=o=>{const e=v(),n=T(o),i=b();return{name:"Rock Paper Scissors",init(){console.log("Initializing Rock Paper Scissors Scene")},onEnter(){e.gameState="idle";const r=d=>n.handleClick(e,d);o.canvas.addEventListener("click",r),this._clickHandler=r;const u=d=>n.handleTouch(e,d);o.canvas.addEventListener("touchstart",u),this._touchHandler=u},onExit(){this._clickHandler&&o.canvas.removeEventListener("click",this._clickHandler),this._touchHandler&&o.canvas.removeEventListener("touchstart",this._touchHandler)},update:r=>{e.gameState==="result"&&e.countdown>0&&(e.countdown-=1),e.gameState==="idle"&&(e.pulseSize+=5e-4*r*e.pulseDir,e.pulseSize>1.2&&(e.pulseDir=-1),e.pulseSize<.8&&(e.pulseDir=1))},render(r){i.renderGame(r,o.canvas,e)},resize(){}}};class A{canvas;keys;mouse;gamepads;touches;constructor(e){this.canvas=e,this.keys={},this.mouse={x:0,y:0,buttons:{},wheel:0},this.gamepads=[],this.touches=new Map,this.#t()}#t(){window.addEventListener("keydown",i=>{this.keys[i.key]=!0,["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(i.key)&&i.preventDefault()}),window.addEventListener("keyup",i=>{this.keys[i.key]=!1});const e={passive:!1};this.canvas.addEventListener("mousemove",i=>{const s=this.canvas.getBoundingClientRect();this.mouse.x=i.clientX-s.left,this.mouse.y=i.clientY-s.top},e),this.canvas.addEventListener("mousedown",i=>{this.mouse.buttons[i.button]=!0},e),this.canvas.addEventListener("mouseup",i=>{this.mouse.buttons[i.button]=!1},e),this.canvas.addEventListener("wheel",i=>{this.mouse.wheel=i.deltaY,i.preventDefault()},{passive:!1});const n={passive:!1,capture:!1};this.canvas.addEventListener("touchstart",i=>{for(const s of Array.from(i.changedTouches)){const r=this.canvas.getBoundingClientRect();this.touches.set(s.identifier,{x:s.clientX-r.left,y:s.clientY-r.top})}i.preventDefault()},n),this.canvas.addEventListener("touchmove",i=>{for(const s of Array.from(i.changedTouches)){const r=this.canvas.getBoundingClientRect();this.touches.set(s.identifier,{x:s.clientX-r.left,y:s.clientY-r.top})}i.preventDefault()},n),this.canvas.addEventListener("touchend",i=>{for(const s of Array.from(i.changedTouches))this.touches.delete(s.identifier);i.preventDefault()},n),window.addEventListener("gamepadconnected",()=>this.#e()),window.addEventListener("gamepaddisconnected",()=>this.#e())}#e(){this.gamepads=Array.from(navigator.getGamepads()).filter(e=>e)}update(){this.#e(),this.mouse.wheel=0}isKeyDown(e){return this.keys[e]||!1}isMouseButtonDown(e){return this.mouse.buttons[e]||!1}getMousePosition(){return{x:this.mouse.x,y:this.mouse.y}}getMouseWheel(){return this.mouse.wheel}getGamepad(e=0){return this.gamepads[e]||null}getTouchCount(){return this.touches.size}getTouchPositions(){return Array.from(this.touches.values())}getTouchPosition(e){return this.touches.get(e)||null}}class L{#t;#e;#i=null;#n=new Map;#s={lastTime:0,fps:0,frameCount:0,lastFpsUpdate:0};#r=new Set;#a;debugMode=!0;#o=0;constructor(){const e=document.getElementById("game-canvas");if(!(e instanceof HTMLCanvasElement))throw new Error("Canvas element not found or not a canvas");this.#t=e;const n=this.#t.getContext("2d");if(!n)throw new Error("Could not get 2D rendering context");this.#e=n,this.#a=new A(this.#t),this.#s.lastTime=performance.now()/1e3,this.#o=0}handleDebugToggle(){this.debugMode=!this.debugMode,console.log(`Debug mode: ${this.debugMode?"ON":"OFF"}`)}#l=()=>{this.#t.width=window.innerWidth,this.#t.height=window.innerHeight,this.#i?.resize?.()};#h(e){const n=e/1e3,i=n-this.#s.lastTime;return this.#s.lastTime=n,this.#o+=i,this.#s.frameCount++,n-this.#s.lastFpsUpdate>=1&&(this.#s.fps=this.#s.frameCount/(n-this.#s.lastFpsUpdate),this.#s.frameCount=0,this.#s.lastFpsUpdate=n),i}#u(){this.#e.fillStyle="white",this.#e.font="16px monospace",this.#e.textAlign="right",this.#e.fillText(`FPS: ${Math.round(this.#s.fps)}`,this.#t.width-10,20),this.#e.fillText(`Scene: ${this.#i?.name||"none"}`,this.#t.width-10,40),this.#e.fillText(`Time: ${this.#o.toFixed(2)}s`,this.#t.width-10,60)}#c=e=>{const n=this.#h(e);this.#a.update(),this.#e.clearRect(0,0,this.#t.width,this.#t.height),this.#i?.update?.(n),this.#i?.render?.(this.#e),this.debugMode&&this.#u(),requestAnimationFrame(this.#c)};initialize(){this.#l(),window.addEventListener("resize",this.#l),requestAnimationFrame(this.#c)}registerScene(e,n){this.#n.set(e,n),n.init?.()}transitionToScene(e){const n=this.#n.get(e);return n?(this.#i?.onExit?.(),this.#i=n,this.#i.name=e,this.#i.onEnter?.(),this.#d(),!0):(console.error(`Scene ${e} not found`),!1)}#d(){this.#r.forEach(e=>e())}get availableScenes(){return Array.from(this.#n.keys()).map(e=>({name:e,displayName:this.#n.get(e)?.displayName||e}))}get activeScene(){return this.#i?.name}get canvas(){return this.#t}get renderingContext(){return this.#e}get input(){return this.#a}onSceneChange(e){return this.#r.add(e),()=>this.#r.delete(e)}getTime(){return this.#o}}class P{gameEngine;constructor(){this.gameEngine=new L}async initialize(){this.gameEngine.initialize()}registerScene(e,n){this.gameEngine.registerScene(e,n)}transitionToScene(e){this.gameEngine.transitionToScene(e)}getGameEngine(){return this.gameEngine}}window.addEventListener("load",async()=>{const o=new P;await o.initialize(),o.registerScene("Rock Paper Scissors",k(o.getGameEngine())),o.transitionToScene("Rock Paper Scissors")});
